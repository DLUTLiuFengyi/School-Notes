### 体系结构

#### 上层程序-内核-底层硬件

Linux将所有**外部设备**看成是一类特殊文件，称之为“设备文件”。

* 系统调用是Linux内核和应用程序之间的接口
* 设备驱动程序是Linux内核与外部设备之间的接口

设备驱动程序向应用程序屏蔽了硬件在实现上的细节，使得应用程序可以像操作普通文件一样来操作外部设备。

#### 硬件

Linux抽象了对硬件的处理，所有的硬件设备都可以像普通文件一样来看待：它们可以使用和操作文件相同的、标准的系统调用接口来完成打开、关闭、读写和I/O控制操作，而驱动程序的主要任务也就是要实现这些系统调用函数。

Linux系统中的所有硬件设备都使用一个特殊的设备文件来表示，例如，系统中的第一个IDE硬盘使用/dev/hda表示。

所有已经注册（即已经加载了驱动程序）的硬件设备的主设备号可以从/proc/devices文件中得到。

使用mknod命令可以创建指定类型的设备文件，同时为其分配相应的主设备号和次设备号。

```shell
#例如，下面命令将建立一个主设备号为6，次设备号为0的字符设备文件/dev/lp0
[root@gary root]# mknod /dev/lp0 c 6 0
```


当应用程序对某个设备文件进行系统调用时，Linux内核会根据该设备文件的设备类型和主设备号调用相应的驱动程序，并从**用户态**进入到**核心态**，再由**驱动程序**判断该设备的次设备号，最终完成对相应**硬件**的操作。

